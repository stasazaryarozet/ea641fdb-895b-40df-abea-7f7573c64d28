# **Техническое Задание (ТЗ): Разработка и внедрение AI-агента для миграции сайтов**

**Версия:** 1.0

**Проект:** Tilda to Google Cloud Migration Agent

## 1. **Общие положения**

### 1.1. **Цель проекта**
Разработать автономного AI-агента, способного полностью автоматизировать процесс миграции веб-сайтов с платформы Tilda на инфраструктуру Google Cloud Platform (GCP).

**Конкретная задача:** В рамках данного ТЗ необходимо выполнить миграцию сайта `parisinseptember.ru`.

### 1.2. **Основные задачи агента**
*   **Извлечение (Extraction):** Полное и точное извлечение всех ресурсов сайта с Tilda.
*   **Обработка (Processing):** Модификация и оптимизация извлеченных ресурсов для автономной работы на стандартном веб-сервере.
*   **Развертывание (Deployment):** Автоматизированное создание и настройка инфраструктуры на GCP и загрузка на нее обработанных ресурсов.
*   **Обработка форм (Form Handling):** Обеспечение работоспособности веб-форм на новом хостинге путем их интеграции с Google Sheets.

## 2. **Функциональные требования**

### 2.1. **Модуль извлечения (Extractor)**
*   Должен использовать Tilda API для получения списка страниц и проектов.
*   Должен скачивать HTML, CSS, JavaScript файлы, изображения, видео и другие ресурсы.
*   Должен сохранять оригинальную структуру директорий и файлов.

### 2.2. **Модуль обработки (Processor)**
*   Должен изменять абсолютные пути на относительные во всех HTML и CSS файлах.
*   Должен удалять все Tilda-специфичные скрипты и виджеты (статистика, "Made on Tilda" и т.д.).
*   **Опционально (управляется через `config.yaml`):**
    *   Оптимизация изображений (сжатие без потерь).
    *   Минификация файлов CSS и JavaScript.
*   Должен модифицировать HTML-формы: атрибут `action` должен указывать на новый эндпоинт, развернутый в GCP.

### 2.3. **Модуль развертывания (Deployer)**
*   Должен использовать GCP API для создания и настройки ресурсов.
*   **Инфраструктура:**
    *   Создание виртуальной машины (VM) в Compute Engine согласно параметрам в `config.yaml` (тип машины, размер диска, образ).
    *   Создание бакета в Google Cloud Storage для хранения медиа-ресурсов (опционально, для больших сайтов).
*   **Веб-сервер:**
    *   Установка и настройка веб-сервера `nginx`.
    *   Конфигурация `nginx` для обслуживания статических файлов сайта.
*   **Безопасность:**
    *   Автоматическое получение и установка SSL-сертификата от Let's Encrypt.
    *   Настройка редиректа с HTTP на HTTPS.
*   **DNS:**
    *   Создание или обновление A-записи в указанной DNS-зоне Google Cloud DNS для направления домена на IP-адрес созданной VM.

### 2.4. **Модуль обработки форм (Form Handler)**
*   Должен автоматически развертывать Google Cloud Function на Node.js или Python.
*   Cloud Function должна принимать POST-запросы от всех форм с мигрированного сайта.
*   Данные из форм должны записываться в указанный Google Sheet.
*   Необходимо обеспечить защиту эндпоинта от спама (например, через reCAPTCHA или скрытые поля).

## 3. **Нефункциональные требования**

### 3.1. **Конфигурация**
*   Все параметры (ключи API, ID проектов, настройки VM, домены и т.д.) должны задаваться в едином файле `config.yaml`.

### 3.2. **Логирование**
*   Агент должен вести подробный лог всех своих действий в файл `execution.log`.
*   Отдельный лог `reasoning.log` должен создаваться для записи логики принятия решений агентом.
*   Уровень детализации логов должен настраиваться через `config.yaml`.

### 3.3. **Надежность и отказоустойчивость**
*   Агент должен корректно обрабатывать ошибки API (Tilda, GCP) и сетевые проблемы, используя механизм повторных попыток (retry).
*   Должен быть реализован режим "dry run", при котором агент только симулирует все действия без реального создания или изменения ресурсов.

### 3.4. **Управление версиями**
*   Весь код проекта должен находиться под управлением системы контроля версий Git. 